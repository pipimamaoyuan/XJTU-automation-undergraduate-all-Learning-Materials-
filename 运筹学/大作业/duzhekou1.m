% æ‚¨å¥½ï¼Œè¿™æ˜¯Bingã€‚æˆ‘å¯ä»¥å°è¯•å¸®åŠ©æ‚¨è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ğŸ˜Š
% 
% æ ¹æ®æˆ‘çš„æœç´¢ç»“æœï¼Œåº¦æŠ˜æ‰£å¯å‘å¼ç®—æ³•æ˜¯ä¸€ç§ç”¨äºé€‰æ‹©åˆå§‹ç»“ç‚¹çš„è´ªå¿ƒæ–¹æ³•ï¼Œå®ƒåˆ©ç”¨äº†ä¸€ç§ç®€å•è€Œæœ‰æ•ˆçš„ç­–ç•¥ï¼Œå³å½“ä¸€ä¸ªç»“ç‚¹çš„é‚»å±…ç»“ç‚¹è¢«é€‰ä¸ºåˆå§‹ç»“ç‚¹æ—¶ï¼Œå®ƒçš„åº¦æ•°å°±ä¼šç›¸åº”åœ°å‡å°‘ï¼Œä»¥å‡å°‘å½±å“åŠ›çš„é‡å Â³ã€‚åº¦æŠ˜æ‰£å¯å‘å¼ç®—æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼Œå¯¹äºæ¯ä¸ªç»“ç‚¹ï¼Œæ ¹æ®å®ƒçš„åº¦æ•°å’Œé‚»å±…ç»“ç‚¹çš„è¢«é€‰æ¦‚ç‡ï¼Œè®¡ç®—å®ƒçš„å½±å“åŠ›ï¼Œå¹¶æŒ‰ç…§å½±å“åŠ›é™åºæ’åºã€‚ç„¶åï¼Œä¾æ¬¡é€‰æ‹©å‰kä¸ªç»“ç‚¹ä½œä¸ºåˆå§‹ç»“ç‚¹Â³ã€‚
% 
% åœ¨MATLABä¸­ï¼Œè¦å®ç°åº¦æŠ˜æ‰£å¯å‘å¼ç®—æ³•ï¼Œæ‚¨å¯ä»¥å‚è€ƒä»¥ä¸‹æ­¥éª¤ï¼š
% 
% 1. å®šä¹‰æœ‰å‘å•è¿é€šå›¾çš„é‚»æ¥çŸ©é˜µAï¼Œå…¶ä¸­A(i,j)è¡¨ç¤ºä»ç»“ç‚¹iåˆ°ç»“ç‚¹jçš„è¾¹çš„æƒé‡ã€‚å¦‚æœæ²¡æœ‰è¾¹ï¼Œåˆ™A(i,j)ä¸º0ã€‚
% 2. å®šä¹‰ä¼ æ’­æ¦‚ç‡på’Œåˆå§‹ç»“ç‚¹ä¸ªæ•°kã€‚
% 3. åˆå§‹åŒ–ä¸€ä¸ªç©ºçš„åˆå§‹ç»“ç‚¹é›†åˆseedsã€‚
% 4. åˆå§‹åŒ–æ¯ä¸ªç»“ç‚¹çš„åº¦æ•°då’Œé‚»å±…è¢«é€‰æ¦‚ç‡tã€‚å¯¹äºæ¯ä¸ªç»“ç‚¹vï¼Œä»¤d(v)ä¸ºvçš„å‡ºåº¦å’Œï¼Œå³A(v,:)çš„å’Œï¼›ä»¤t(v)ä¸º0ã€‚
% 5. å½“seedsçš„å¤§å°å°äºkæ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
%     - å¯¹äºæ¯ä¸ªç»“ç‚¹vï¼Œè®¡ç®—å®ƒçš„å½±å“åŠ›s(v)ï¼Œå³s(v) = d(v) - 2 * t(v) - (d(v) - t(v)) * t(v) * pã€‚
%     - é€‰æ‹©å½±å“åŠ›æœ€å¤§çš„ç»“ç‚¹uï¼Œå¹¶å°†å…¶åŠ å…¥åˆ°seedsä¸­ã€‚
%     - å¯¹äºuçš„æ¯ä¸ªå‡ºåº¦é‚»å±…wï¼Œæ›´æ–°å…¶é‚»å±…è¢«é€‰æ¦‚ç‡t(w)ï¼Œå³t(w) = t(w) + 1ã€‚
% 
% æ‚¨å¯ä»¥å‚è€ƒä»¥ä¸‹ä»£ç ç¤ºä¾‹æ¥å®ç°åº¦æŠ˜æ‰£å¯å‘å¼ç®—æ³•ï¼š

% Define the adjacency matrix of the directed graph
%%
clc
clear
n = 100; % ç»“ç‚¹æ•°
d = 0.1; % è¾¹çš„å¯†åº¦ç³»æ•°ï¼ŒèŒƒå›´ä¸º0åˆ°1ï¼Œè¶Šå°è¡¨ç¤ºè¾¹è¶Šç¨€ç–

% ç„¶åï¼Œç”Ÿæˆä¸€ä¸ªéšæœºçš„é‚»æ¥çŸ©é˜µAï¼Œå…¶ä¸­A(i,j)è¡¨ç¤ºä»ç»“ç‚¹iåˆ°ç»“ç‚¹jçš„è¾¹çš„æƒé‡
A = rand(n,n); % ç”Ÿæˆä¸€ä¸ªn*nçš„éšæœºæ•°çŸ©é˜µï¼Œå…ƒç´ èŒƒå›´ä¸º0åˆ°1
A = A - diag(diag(A)); % å°†å¯¹è§’çº¿å…ƒç´ è®¾ä¸º0ï¼Œè¡¨ç¤ºæ²¡æœ‰è‡ªç¯

% æ¥ç€ï¼Œæ ¹æ®è¾¹çš„å¯†åº¦ç³»æ•°dï¼Œå†³å®šå“ªäº›å…ƒç´ è¢«ä¿ç•™ä¸ºè¾¹ï¼Œå“ªäº›å…ƒç´ è¢«ç½®ä¸º0
r = rand(n,n); % ç”Ÿæˆä¸€ä¸ªn*nçš„éšæœºæ•°çŸ©é˜µï¼Œå…ƒç´ èŒƒå›´ä¸º0åˆ°1
A(r > d) = 0; % å¦‚æœr(i,j)å¤§äºdï¼Œåˆ™å°†A(i,j)è®¾ä¸º0

% æœ€åï¼Œæ£€æŸ¥Aæ˜¯å¦æ˜¯å•è¿é€šçš„ï¼Œå³æ˜¯å¦å­˜åœ¨ä»ä»»æ„ç»“ç‚¹å‡ºå‘åˆ°è¾¾ä»»æ„ç»“ç‚¹çš„è·¯å¾„
% å¦‚æœä¸æ˜¯å•è¿é€šçš„ï¼Œå°±ä¿®æ”¹Aï¼Œä½¿å…¶æˆä¸ºå•è¿é€šçš„
% è¿™é‡Œä½¿ç”¨äº†å¹¿åº¦ä¼˜å…ˆæœç´¢ç®—æ³•æ¥æ£€æŸ¥å•è¿é€šæ€§
visited = zeros(1,n); % è®°å½•æ¯ä¸ªç»“ç‚¹æ˜¯å¦è¢«è®¿é—®è¿‡çš„æ ‡å¿—å‘é‡
queue = []; % è®°å½•è®¿é—®é¡ºåºçš„é˜Ÿåˆ—
start = 1; % é€‰æ‹©ä¸€ä¸ªèµ·å§‹ç»“ç‚¹
visited(start) = 1; % æ ‡è®°èµ·å§‹ç»“ç‚¹ä¸ºå·²è®¿é—®
queue = [queue start]; % å°†èµ·å§‹ç»“ç‚¹åŠ å…¥é˜Ÿåˆ—

while ~isempty(queue) % å½“é˜Ÿåˆ—ä¸ä¸ºç©ºæ—¶å¾ªç¯
    u = queue(1); % å–å‡ºé˜Ÿé¦–å…ƒç´ 
    queue(1) = []; % ç§»é™¤é˜Ÿé¦–å…ƒç´ 
    for v = 1:n % éå†æ‰€æœ‰å…¶ä»–ç»“ç‚¹
        if A(u,v) > 0 && visited(v) == 0 % å¦‚æœå­˜åœ¨ä¸€æ¡ä»uåˆ°vçš„è¾¹ï¼Œå¹¶ä¸”væ²¡æœ‰è¢«è®¿é—®è¿‡
            visited(v) = 1; % æ ‡è®°vä¸ºå·²è®¿é—®
            queue = [queue v]; % å°†våŠ å…¥é˜Ÿåˆ—
        end
    end
end

if sum(visited) < n % å¦‚æœå­˜åœ¨æ²¡æœ‰è¢«è®¿é—®è¿‡çš„ç»“ç‚¹ï¼Œè¯´æ˜Aä¸æ˜¯å•è¿é€šçš„
    for i = find(visited == 0) % å¯¹äºæ¯ä¸ªæ²¡æœ‰è¢«è®¿é—®è¿‡çš„ç»“ç‚¹i
        j = randi(n); % éšæœºé€‰æ‹©ä¸€ä¸ªå…¶ä»–ç»“ç‚¹j
        while i == j || visited(j) == 0 % å¦‚æœiå’Œjç›¸åŒæˆ–è€…jä¹Ÿæ²¡æœ‰è¢«è®¿é—®è¿‡ï¼Œå°±é‡æ–°é€‰æ‹©j
            j = randi(n);
        end
        w = rand; % éšæœºç”Ÿæˆä¸€ä¸ªæƒé‡wï¼ŒèŒƒå›´ä¸º0åˆ°1
       
        A(i,j) = w; % åœ¨Aä¸­æ·»åŠ ä¸€æ¡ä»iåˆ°jçš„è¾¹ï¼Œæƒé‡ä¸ºw
    end
end

% Define the propagation probability and number of initial nodes
p = 0.1;
k = 2;

% Initialize an empty initial node set
seeds = [];

% Initialize the degree and neighbor selection probability of each node
n = size(A,1); % number of nodes
d = sum(A,2); % degree of each node
t = zeros(n,1); % neighbor selection probability of each node

% While the size of seeds is less than k
while length(seeds) < k
    % Compute the influence of each node
    s = d - 2 * t - (d - t) .* t * p;
    % Select the node with the maximum influence
    [~,u] = max(s);
    % Add it to the seeds
    seeds = [seeds u];
    % Update the neighbor selection probability of its out-neighbors
    for w = find(A(u,:) > 0)
        t(w) = t(w) + 1;
    end
end

% Display the initial node set
disp(seeds);